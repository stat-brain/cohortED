% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_distribution_mobility.R
\name{plot_distribution_mobility}
\alias{plot_distribution_mobility}
\title{Plot Student Mobility Distribution by Grade}
\usage{
plot_distribution_mobility(
  dataset,
  current_year,
  start_grade = NULL,
  end_grade = NULL,
  print_plot = TRUE
)
}
\arguments{
\item{dataset}{A data frame containing at minimum the columns: \code{id} (student identifier), \code{grade} (grade level), and \code{year}
(academic year, such as "2022-23" or just the numeric starting year "2022").}

\item{current_year}{A numeric or character value indicating the current academic year of interest. If character, the function will
extract the starting year (e.g., "2022-23" → 2022). The function compares this year to the previous year to calculate mobility.}

\item{start_grade}{Optional. The lowest grade to include in the analysis. Accepts character (e.g., "K", "PK", "PreK") or numeric values.
If \code{NULL}, defaults to 2.}

\item{end_grade}{Optional. The highest grade to include in the analysis. Accepts character or numeric values. If \code{NULL}, defaults to 12.}

\item{print_plot}{Logical. If \code{TRUE}, prints a bar chart of the mobility distribution to the plotting device. Default is \code{TRUE}.}
}
\value{
An (invisible) list with the following components:
\describe{
\item{\code{Data}}{A data frame with one row per grade per mobility status, including columns:
\code{MOBILITY} ("Leave", "Stay", or "Join"), \code{GRADE}, \code{COUNT}, \code{PROPORTION}, and \code{PERCENT}.}
\item{\code{Plot}}{A ggplot2 object visualizing the mobility distribution across grade levels.}
\item{\code{Table}}{A matrix of formatted percentages, cross-tabulated by mobility status (rows) and grade level (columns).}
\item{\code{Caption}}{A caption string describing the year range used in the plot and table.}
}
}
\description{
This function visualizes student mobility across grades between two academic years by computing the proportion of students who
"Stay" (enrolled both years in the expected grade progression), "Left" (enrolled in the previous year but not the current year),
or "Join" (enrolled in the current year but not the previous year). It supports flexible grade inputs (e.g., numeric, "K", "PK", "PreK").
}
\details{
This function assumes that students typically progress one grade level per year. For example, a student in Grade 4 in 2021-22 is
expected to be in Grade 5 in 2022-23. The function identifies mobility based on this assumption and compares student \code{id}s between
years and adjacent grades.

The function also normalizes common grade label inputs using the internal \code{normalize_grade()} function:
\itemize{
\item \code{"K"} → 0
\item \code{"PK"}, \code{"PreK"}, \code{"prek"} → -1
\item Numeric grades (e.g., 1–12) are kept as-is
}

Missing data for \code{grade} or \code{year} is excluded prior to analysis.
}
\examples{
plot_distribution_mobility(dataset = math, current_year = 2022, start_grade = 4, end_grade = 6)


}
\seealso{
\code{\link{make_mobility}}
}

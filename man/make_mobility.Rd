% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/make_mobility.R
\name{make_mobility}
\alias{make_mobility}
\title{Make Mobility}
\usage{
make_mobility(dataset, current_year, current_grade, print_plot = FALSE)
}
\arguments{
\item{dataset}{A data frame containing student-level data. Must include columns for
student ID, grade, and academic year. Column names are case-insensitive.
The grade column may contain numeric values, or special codes:
\itemize{
\item \code{"K"} for Kindergarten (treated as 0),
\item \code{"PK"} or \code{"PreK"} for Pre-Kindergarten (treated as -1).
}}

\item{current_year}{The academic year of the current grade (e.g., \code{"2020-2021"} or numeric year \code{2020}).
Can be a string or numeric. The function extracts the starting calendar year if a string.}

\item{current_grade}{Numeric or convertible to numeric, or a string representing grade level.
Supports \code{"K"}, \code{"PK"}, and \code{"PreK"} as described above.}

\item{print_plot}{Logical (default: \code{FALSE}). If \code{TRUE}, prints the mobility distribution bar plot.}
}
\value{
A list with the following components:
\describe{
\item{Data}{A data frame merging student data from previous and current year/grade with mobility status.}
\item{Table}{A one-row matrix with percentages of students who "Leave", "Stay", or "Join".}
\item{Caption}{A character string describing the grade and year comparison used.}
\item{Barplot}{A ggplot2 bar plot object visualizing mobility distribution percentages.}
}
}
\description{
Calculate Student Mobility Between Grades and Years
}
\details{
This function analyzes student mobility status by comparing student IDs
between two consecutive academic years and grades. It categorizes students as
"Leave" (present in previous year/grade only), "Join" (present in current year/grade only),
or "Stay" (present in both). It returns a summary table, a merged dataset with mobility
status, and a bar plot visualizing the distribution.

The function:
\itemize{
\item Validates required columns ("id", "grade", "year") exist (case-insensitive).
\item Converts special grade codes \code{"K"}, \code{"PK"}, and \code{"PreK"} to numeric equivalents (\code{0} and \code{-1} respectively) for computation.
\item Extracts the calendar year from the academic year (first 4 characters).
\item Computes mobility status by comparing student IDs from the previous grade/year
to the current grade/year.
\item Always returns percentages for all three mobility categories, even if some have zero counts.
\item Produces a bar plot showing the distribution with custom colors for each status.
}
}
\examples{
make_mobility(dataset = math, current_year = "2020_2021", current_grade = 4)
make_mobility(dataset = math, current_year = 2022, current_grade = 7)

}
